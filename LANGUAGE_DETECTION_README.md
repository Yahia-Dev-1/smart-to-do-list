# نظام كشف اللغة التلقائي للدردشة AI

## الميزات المضافة

1. **كشف اللغة التلقائي**: النظام يكتشف لغة رسالة المستخدم تلقائياً
2. **الرد بنفس اللغة**: الـ AI يرد بنفس لغة رسالة المستخدم
3. **عرض لغة الرد**: تظهر لغة الرد بجانب كل رسالة
4. **دعم اللغتين**: العربية والإنجليزية

## كيفية العمل

### 1. كشف اللغة
- عند إرسال رسالة، يقوم النظام بتحليل النص لاكتشاف اللغة
- الخوارزمية تحسب نسبة الأحرف العربية مقابل الإنجليزية
- إذا كانت النسبة لصالح العربية (>40%)، يتم اعتبار النص عربي
- إذا بدأ النص بكلمة عربية، يتم إعطاؤه وزن إضافي

### 2. إرسال اللغة إلى الـ Backend
- يتم إرسال اللغة المكتشفة مع الرسالة إلى الـ AI backend
- الـ backend يستخدم هذه المعلومات للرد بنفس اللغة

### 3. عرض اللغة
- تظهر أيقونة عالم صغيرة بجانب كل رسالة
- تظهر اسم اللغة المكتشفة (English أو العربية)
- أثناء التحميل، تظهر لغة الرد المتوقعة

## الملفات المعدلة

### 1. `src/utils/languageDetector.js`
- ملف جديد يحتوي على خوارزمية كشف اللغة
- دوال: `detect(text)` و `getLanguageName(langCode)`

### 2. `src/utils/aiEngine.js`
- تم تحديث دالة `sendChatMessage`
- تضيف اللغة المكتشفة إلى بيانات الطلب المرسلة للـ backend

### 3. `src/nav/AIChatSidebar.jsx`
- تم إضافة استيراد `languageDetector`
- تم إضافة حالة `detectedLang`
- تم تحديث `handleSend` لاكتشاف اللغة
- تم تحديث عرض الرسائل لإظهار اللغة

### 4. `src/nav/aichat.css`
- تم إضافة تنسيقات لعرض لغة الرسالة

## أمثلة

### رسالة عربية:
```
المستخدم: مرحبا، كيف يمكنني تحسين إنتاجيتي؟
اللغة: العربية
الـ AI: يمكنك تحسين إنتاجيتك عن طريق...
```

### رسالة إنجليزية:
```
User: Hello, how can I improve my productivity?
Language: English
AI: You can improve your productivity by...
```

### رسالة مختلطة:
```
User: Hello مرحبا
Language: English (إذا كانت النسبة لصالح الإنجليزية)
AI: You can...
```

## تحسينات مستقبلية محتملة

1. دعم لغات إضافية (فرنسية، إسبانية، إلخ)
2. تحسين دقة كشف اللغة للرسائل القصيرة
3. إضافة خيار للمستخدم لتحديد اللغة يدوياً
4. حفظ تفضيلات اللغة لكل مستخدم